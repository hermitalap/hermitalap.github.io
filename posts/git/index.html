<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="noodp" />
    <title class="pjax-title">Git - imzifeng</title><meta name="Description" content="无名的自留地."><meta property="og:title" content="Git" />
<meta property="og:description" content="Git 是一个分布式版本控制系统. 文本，脚本，以及各种基于文本信息的文件可被Git管理 各软件私有格式、二进制文件、媒体不可被Git管理 安装 官方下载" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://imzifeng.cn/posts/git/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-09-01T16:36:49+08:00" />
<meta property="article:modified_time" content="2021-09-01T16:36:49+08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Git"/>
<meta name="twitter:description" content="Git 是一个分布式版本控制系统. 文本，脚本，以及各种基于文本信息的文件可被Git管理 各软件私有格式、二进制文件、媒体不可被Git管理 安装 官方下载"/>
<meta name="application-name" content="imzifeng">
<meta name="apple-mobile-web-app-title" content="imzifeng">

<meta name="theme-color" content="#ffffff"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://imzifeng.cn/posts/git/" /><link rel="prev" href="http://imzifeng.cn/posts/rnaseq-1/" /><link rel="next" href="http://imzifeng.cn/posts/usbflashdiskantivirus/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/lib/fontawesome-free/all.min.css">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/lib/animate/animate.min.css">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Git",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/imzifeng.cn\/posts\/git\/"
        },"genre": "posts","wordcount":  6585 ,
        "url": "http:\/\/imzifeng.cn\/posts\/git\/","datePublished": "2021-09-01T16:36:49+08:00","dateModified": "2021-09-01T16:36:49+08:00","publisher": {
            "@type": "Organization",
            "name": "zifeng"},"author": {
                "@type": "Person",
                "name": "zifeng"
            },"description": ""
    }
    </script></head>

<body header-desktop="" header-mobile=""><script type="text/javascript">
        function setTheme(theme) {document.body.setAttribute('theme', theme);}
        function saveTheme(theme) {window.localStorage && localStorage.setItem('theme', theme);}
        function getMeta(metaName) {const metas = document.getElementsByTagName('meta'); for (let i = 0; i < metas.length; i++) if (metas[i].getAttribute('name') === metaName) return metas[i]; return '';}
        if (window.localStorage && localStorage.getItem('theme')) {let theme = localStorage.getItem('theme');theme === 'light' || theme === 'dark' || theme === 'black' ? setTheme(theme) : (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? setTheme('dark') : setTheme('light')); } else { if ('auto' === 'light' || 'auto' === 'dark' || 'auto' === 'black') setTheme('auto'), saveTheme('auto'); else saveTheme('auto'), window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? setTheme('dark') : setTheme('light');}
        let themeColorMeta = getMeta('theme-color');
        if (document.body.getAttribute('theme') != 'light') themeColorMeta.content = '#000000';
    </script>
    <div id="back-to-top"></div>
    <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="imzifeng">imzifeng</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> 文章 </a><a class="menu-item" href="/tags/"> 标签 </a><a class="menu-item" href="/categories/"> 分类 </a><a class="menu-item" href="/about/"> 关于 </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="搜索文章标题或内容…" id="search-input-desktop">
                        <a href="#" onclick="return false;" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="#" onclick="return false;" class="search-button search-clear" id="search-clear-desktop" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="#" onclick="return false;" class="menu-item theme-switch" title="切换主题">
                    <i class="fas fa-adjust fa-fw"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="imzifeng">imzifeng</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="搜索文章标题或内容…" id="search-input-mobile">
                        <a href="#" onclick="return false;" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="#" onclick="return false;" class="search-button search-clear" id="search-clear-mobile" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="#" onclick="return false;" class="search-cancel" id="search-cancel-mobile">
                        取消
                    </a>
                </div><a class="menu-item" href="/posts/" title="">文章</a><a class="menu-item" href="/tags/" title="">标签</a><a class="menu-item" href="/categories/" title="">分类</a><a class="menu-item" href="/about/" title="">关于</a><a href="#" onclick="return false;" class="menu-item theme-switch" title="切换主题">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
            <div class="container"><div class="toc" id="toc-auto">
        <h2 class="toc-title">目录</h2>
        <div class="toc-content" id="toc-content-auto"></div>
    </div><script>document.getElementsByTagName("main")[0].setAttribute("pageStyle", "normal")</script><script>document.getElementsByTagName("main")[0].setAttribute("autoTOC", "true")</script><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Git</h1><div class="post-meta">
            <div class="post-meta-line">
                <span class="post-author"><i class="author fas fa-user-circle fa-fw"></i><a href="/" title="Author" rel=" author" class="author">zifeng</a>
                </span>&nbsp;<span class="post-category">收录于 </span>&nbsp;<span class="post-category">类别 <a href="/categories/doc/"><i class="far fa-folder fa-fw"></i>Doc</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2021-09-01">2021-09-01</time>&nbsp;<i class="far fa-edit fa-fw"></i>&nbsp;<time datetime="2021-09-01">2021-09-01</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 6585 字&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 14 分钟&nbsp;<span id="/posts/git/" class="leancloud_visitors" data-flag-title="Git">
                        <i class="far fa-eye fa-fw"></i>&nbsp;<span class=leancloud-visitors-count id=twikoo_visitors></span>&nbsp;次阅读
                    </span>&nbsp;</div>
        </div><div class="featured-image"><img
        class="lazyload"
        data-src="/posts/git/Pasted%20image%2020210901175904.png"
        data-srcset="/posts/git/Pasted%20image%2020210901175904.png, /posts/git/Pasted%20image%2020210901175904.png 1.5x, /posts/git/Pasted%20image%2020210901175904.png 2x"
        data-sizes="auto"
        alt="/posts/git/Pasted%20image%2020210901175904.png"
        title="/posts/git/Pasted%20image%2020210901175904.png" height="98" width="340"
    /></div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>目录</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#安装">安装</a>
      <ul>
        <li><a href="#gui管理器">GUI管理器</a></li>
      </ul>
    </li>
    <li><a href="#基本使用">基本使用</a>
      <ul>
        <li><a href="#基本配置">基本配置</a></li>
        <li><a href="#init创建版本库-repository">(init）创建版本库 Repository</a></li>
        <li><a href="#add添加文件管理">(add）添加文件管理</a></li>
        <li><a href="#commit提交改变">(commit）提交改变</a></li>
        <li><a href="#log修改记录">(log）修改记录</a></li>
        <li><a href="#diff查看-unstaged">(diff）查看 unstaged</a></li>
        <li><a href="#diff---cached查看-staged">(diff &ndash;cached）查看 staged</a></li>
        <li><a href="#diff-head查看-staged--unstaged">(diff HEAD）查看 staged &amp; unstaged</a></li>
        <li><a href="#commit---amend修改已-commit-的版本">(commit &ndash;amend）修改已 commit 的版本</a></li>
        <li><a href="#reset回到unstaged状态">(reset）回到unstaged状态</a></li>
        <li><a href="#reset---hard-xxxxxx回到-commit-之前">(reset &ndash;hard xxxxxx）回到 commit 之前</a></li>
        <li><a href="#checkout改写文件">(checkout）改写文件</a></li>
      </ul>
    </li>
    <li><a href="#分支管理">分支管理</a>
      <ul>
        <li><a href="#branch-dev使用branch创建分支">(branch dev）使用branch创建分支</a></li>
        <li><a href="#log---oneline---graph使用graph观看分支">(log &ndash;oneline &ndash;graph）使用graph观看分支</a></li>
        <li><a href="#checkout--b直接创建并切换到新建的分支">(checkout -b）直接创建并切换到新建的分支</a></li>
        <li><a href="#merge将-dev-的修改推送到-master">(merge）将 dev 的修改推送到 master</a></li>
        <li><a href="#commit解决冲突">(commit）解决冲突</a></li>
        <li><a href="#rebase变基">(rebase）变基</a></li>
        <li><a href="#stash临时修改">(stash）临时修改</a></li>
      </ul>
    </li>
    <li><a href="#merge和rebase的区别">merge和rebase的区别</a>
      <ul>
        <li><a href="#merge">merge</a></li>
        <li><a href="#rebase">rebase</a></li>
        <li><a href="#区别">区别</a></li>
      </ul>
    </li>
    <li><a href="#补充">补充</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h1 id="git-是一个分布式版本控制系统">Git 是一个分布式版本控制系统.</h1>
<p>文本，脚本，以及各种基于文本信息的文件可被Git管理</p>
<p>各软件私有格式、二进制文件、媒体不可被Git管理</p>
<h2 id="安装">安装</h2>
<p>官方下载地址，<a href="https://git-scm.com/downloads" target="_blank" rel="noopener noreffer">Git</a></p>
<h3 id="gui管理器">GUI管理器</h3>
<p><a href="https://desktop.github.com/" target="_blank" rel="noopener noreffer">GitHub Desktop</a>
<a href="https://www.sourcetreeapp.com/" target="_blank" rel="noopener noreffer">Sourcetree</a></p>
<h2 id="基本使用">基本使用</h2>
<h3 id="基本配置">基本配置</h3>
<p>设置个人信息，用于将修改与人对应</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">$ git config --global user.name &#34;username&#34;
$ git config --global user.email &#34;email@example.com&#34;
</code></pre></td></tr></table>
</div>
</div><h3 id="init创建版本库-repository">(init）创建版本库 Repository</h3>
<p>首先cd到你要管理的文件夹
然后创建</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">git init
<span class="c1"># Initialized empty Git repository in somefoloers/.git/</span>

<span class="c1"># 提示：使用 &#39;master&#39; 作为初始分支的名称。这个默认分支名称可能会更改。要在新仓库中</span>
<span class="c1"># 提示：配置使用初始分支名，并消除这条警告，请执行：</span>
<span class="c1"># 提示：</span>
<span class="c1"># 提示：  git config --global init.defaultBranch &lt;名称&gt;</span>
<span class="c1"># 提示：</span>
<span class="c1"># 提示：除了 &#39;master&#39; 之外，通常选定的名字有 &#39;main&#39;、&#39;trunk&#39; 和 &#39;development&#39;。</span>
<span class="c1"># 提示：可以通过以下命令重命名刚创建的分支：</span>
<span class="c1"># 提示：</span>
<span class="c1"># 提示：  git branch -m &lt;name&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>git 创建的管理库文件 <code>.git</code> 是被隐藏起来的</p>
<h3 id="add添加文件管理">(add）添加文件管理</h3>
<p>建立一个新的 1.py 文件:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ touch first.py
</code></pre></td></tr></table>
</div>
</div><p>现在 <code>first.py</code> 并没有被放入版本库中 (unstaged), 所以我们要使用 <code>add</code> 把它添加进版本库 (staged):</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ git add first.py

<span class="c1"># 再次查看状态 status</span>
$ git status
位于分支 master  
  
尚无提交  
  
要提交的变更：  
（使用 <span class="s2">&#34;git rm --cached &lt;文件&gt;...&#34;</span> 以取消暂存）  
新文件： first.py
</code></pre></td></tr></table>
</div>
</div><p>如果想一次性添加文件夹中所有未被添加的文件, 可以使用这个:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ git add .
</code></pre></td></tr></table>
</div>
</div><h3 id="commit提交改变">(commit）提交改变</h3>
<p>我们已经添加好了 <code>first.py</code> 文件, 最后一步就是提交这次的改变, 并在 <code>-m</code> 自定义这次改变的信息:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ git commit -m <span class="s2">&#34;create first.py&#34;</span>

<span class="c1"># 输出</span>
<span class="o">[</span>master（根提交） d722a66<span class="o">]</span> create first.py  
<span class="m">1</span> file changed, <span class="m">0</span> insertions<span class="o">(</span>+<span class="o">)</span>, <span class="m">0</span> deletions<span class="o">(</span>-<span class="o">)</span>  
create mode <span class="m">100644</span> first.py

$ git commit -am <span class="s2">&#34;change 3 in dev&#34;</span> <span class="c1"># &#34;-am&#34;: add 所有改变 并直接 commit</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="log修改记录">(log）修改记录</h3>
<p>查看</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ git log

<span class="c1"># 输出</span>
commit d722a6689063eebd44a4584c07c7bf613520b5d5 <span class="o">(</span>HEAD -&gt; master<span class="o">)</span>  
Author: xxx &lt;xxx@126.com&gt;  
Date: Mon Aug <span class="m">30</span> 21:38:36 <span class="m">2021</span> +0800  

create first.py

$ git log --oneline <span class="c1"># &#34;--oneline&#34;: 每个 commit 内容显示在一行,更简洁，不显示时间</span>

9aeb5f1 <span class="o">(</span>HEAD -&gt; master<span class="o">)</span> create second.py  
d722a66 create first.py
</code></pre></td></tr></table>
</div>
</div><h3 id="diff查看-unstaged">(diff）查看 unstaged</h3>
<p>如果想要查看这次还没 <code>add</code> (unstaged) 的修改部分 和上个已经 <code>commit</code> 的文件有何不同, 我们将使用 <code>$ git diff</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ git diff

<span class="c1"># 输出</span>
diff --git a/first.py b/first.py  
index e69de29..1337a53 <span class="m">100644</span>  
--- a/first.py  
+++ b/first.py  
@@ -0,0 +1 @@  
+a <span class="o">=</span> <span class="m">1</span>
</code></pre></td></tr></table>
</div>
</div><p>注意这里不会显示你还没有追踪的文件，也就是还没有add的文件修改并不会被显示</p>
<h3 id="diff---cached查看-staged">(diff &ndash;cached）查看 staged</h3>
<p>如果你已经 <code>add</code> 了这次修改, 文件变成了 “可提交状态 (staged)”, 我们可以在 <code>diff</code> 中添加参数 <code>--cached</code> 来查看修改:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ git add .   <span class="c1"># add 全部修改文件</span>
$ git diff --cached

<span class="c1"># 输出</span>
diff --git a/1.py b/1.py
index 1337a53..ff7c36c <span class="m">100644</span>
--- a/1.py
+++ b/1.py
@@ -1 +1,2 @@
-a <span class="o">=</span> <span class="m">1</span>
+a <span class="o">=</span> <span class="m">2</span>
+b <span class="o">=</span> <span class="m">1</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="diff-head查看-staged--unstaged">(diff HEAD）查看 staged &amp; unstaged</h3>
<p>显示所有的修改，不管是否为staged（已add）或unstaged（未add）</p>
<p>目前 <code>a = 2</code> 和 <code>b = 1</code> 已被 <code>add</code>, <code>c = b</code> 是新的修改, 还没被 <code>add</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="c1"># 对比三种不同 diff 形式</span>
$ git diff HEAD     <span class="c1"># staged &amp; unstaged</span>

@@ -1 +1,3 @@
-a <span class="o">=</span> <span class="m">1</span>  <span class="c1"># 已 staged</span>
+a <span class="o">=</span> <span class="m">2</span>  <span class="c1"># 已 staged</span>
+b <span class="o">=</span> <span class="m">1</span>  <span class="c1"># 已 staged</span>
+c <span class="o">=</span> b  <span class="c1"># 还没 add 去 stage (unstaged)</span>
-----------------------
$ git diff          <span class="c1"># unstaged</span>

@@ -1,2 +1,3 @@
 <span class="nv">a</span> <span class="o">=</span> <span class="m">2</span>  <span class="c1"># 注: 前面没有 +</span>
 <span class="nv">b</span> <span class="o">=</span> <span class="m">1</span>  <span class="c1"># 注: 前面没有 +</span>
+c <span class="o">=</span> b  <span class="c1"># 还没 add 去 stage (unstaged)</span>
-----------------------
$ git diff --cached <span class="c1"># staged</span>

@@ -1 +1,2 @@
-a <span class="o">=</span> <span class="m">1</span>  <span class="c1"># 已 staged</span>
+a <span class="o">=</span> <span class="m">2</span>  <span class="c1"># 已 staged</span>
+b <span class="o">=</span> <span class="m">1</span>  <span class="c1"># 已 staged</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="commit---amend修改已-commit-的版本">(commit &ndash;amend）修改已 commit 的版本</h3>
<p>有时候我们总会忘了什么, 比如已经提交了 <code>commit</code> 却发现在这个 <code>commit</code> 中忘了附上另一个文件. 接下来我们模拟这种情况. 上节内容中, 我们最后一个 <code>commit</code> 是 <code>change 2</code>, 我们将要添加另外一个文件, 将这个修改也 <code>commit</code> 进 <code>change 2</code>. 所以我们复制 <code>1.py</code> 这个文件, 改名为 <code>2.py</code>. 并把 <code>2.py</code> 变成 <code>staged</code>, 然后使用 <code>--amend</code> 将这次改变合并到之前的 <code>change 2</code> 中.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ git add 2.py
$ git commit --amend --no-edit   <span class="c1"># &#34;--no-edit&#34;: 不编辑, 直接合并到上一个 commit</span>
$ git log --oneline    <span class="c1"># &#34;--oneline&#34;: 每个 commit 内容显示在一行</span>

<span class="c1"># 输出</span>
904e1ba change <span class="m">2</span>    <span class="c1"># 合并过的 change 2</span>
c6762a1 change <span class="m">1</span>
13be9a7 create 1.py
</code></pre></td></tr></table>
</div>
</div><h3 id="reset回到unstaged状态">(reset）回到unstaged状态</h3>
<p>有时我们添加 <code>add</code> 了修改, 但是又后悔, 并想补充一些内容再 <code>add</code>. 这时, 我们有一种方式可以回到 <code>add</code> 之前. 比如在 <code>1.py</code> 文件中添加这一行:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">d = 3
</code></pre></td></tr></table>
</div>
</div><p>然后 <code>add</code> 去 <code>staged</code> 再返回到 <code>add</code> 之前:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ git add 1.py
$ git status -s <span class="c1"># &#34;-s&#34;: status 的缩写模式</span>
<span class="c1"># 输出</span>
M  1.py     <span class="c1"># staged，绿色M</span>
-----------------------
$ git reset 1.py
<span class="c1"># 输出</span>
重置后取消暂存的变更：  
M 1.py
-----------------------
$ git status -s
<span class="c1"># 输出</span>
 M 1.py     <span class="c1"># unstaged，红色M</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="reset---hard-xxxxxx回到-commit-之前">(reset &ndash;hard xxxxxx）回到 commit 之前</h3>
<p>在穿梭到过去的 <code>commit</code> 之前, 我们必须了解 git 是如何一步一步累加更改的. 我们截取网上的一些图片</p>
<p><figure><a class="lightgallery" href="/posts/git/Pasted%20image%2020210903164629.png" title="/posts/git/Pasted%20image%2020210903164629.png" data-thumbnail="/posts/git/Pasted%20image%2020210903164629.png" data-sub-html="<h2> </h2>">
        <img
            class="lazyload"
            data-src="Pasted%20image%2020210903164629.png"
            data-srcset="/posts/git/Pasted%20image%2020210903164629.png, Pasted%20image%2020210903164629.png 1.5x, /posts/git/Pasted%20image%2020210903164629.png 2x"
            data-sizes="auto"
            alt="/posts/git/Pasted%20image%2020210903164629.png"
        />
    </a><figcaption class="image-caption"> </figcaption>
    </figure></p>
<p><figure><a class="lightgallery" href="/posts/git/Pasted%20image%2020210903164635.png" title="/posts/git/Pasted%20image%2020210903164635.png" data-thumbnail="/posts/git/Pasted%20image%2020210903164635.png" data-sub-html="<h2> </h2>">
        <img
            class="lazyload"
            data-src="Pasted%20image%2020210903164635.png"
            data-srcset="/posts/git/Pasted%20image%2020210903164635.png, Pasted%20image%2020210903164635.png 1.5x, /posts/git/Pasted%20image%2020210903164635.png 2x"
            data-sizes="auto"
            alt="/posts/git/Pasted%20image%2020210903164635.png"
        />
    </a><figcaption class="image-caption"> </figcaption>
    </figure></p>
<p><figure><a class="lightgallery" href="/posts/git/Pasted%20image%2020210903164641.png" title="/posts/git/Pasted%20image%2020210903164641.png" data-thumbnail="/posts/git/Pasted%20image%2020210903164641.png" data-sub-html="<h2> </h2>">
        <img
            class="lazyload"
            data-src="Pasted%20image%2020210903164641.png"
            data-srcset="/posts/git/Pasted%20image%2020210903164641.png, Pasted%20image%2020210903164641.png 1.5x, /posts/git/Pasted%20image%2020210903164641.png 2x"
            data-sizes="auto"
            alt="/posts/git/Pasted%20image%2020210903164641.png"
        />
    </a><figcaption class="image-caption"> </figcaption>
    </figure></p>
<p><figure><a class="lightgallery" href="/posts/git/Pasted%20image%2020210903164647.png" title="/posts/git/Pasted%20image%2020210903164647.png" data-thumbnail="/posts/git/Pasted%20image%2020210903164647.png" data-sub-html="<h2> </h2>">
        <img
            class="lazyload"
            data-src="Pasted%20image%2020210903164647.png"
            data-srcset="/posts/git/Pasted%20image%2020210903164647.png, Pasted%20image%2020210903164647.png 1.5x, /posts/git/Pasted%20image%2020210903164647.png 2x"
            data-sizes="auto"
            alt="/posts/git/Pasted%20image%2020210903164647.png"
        />
    </a><figcaption class="image-caption"> </figcaption>
    </figure></p>
<p>每个 <code>commit</code> 都有自己的 <code>id</code> 数字号, <code>HEAD</code> 是一个指针, 指引当前的状态是在哪个 <code>commit</code>. 最近的一次 <code>commit</code> 在最右边, 我们如果要回到过去, 就是让 <code>HEAD</code> 回到过去并 <code>reset</code> 此时的 <code>HEAD</code> 到过去的位置.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="c1"># 不管我们之前有没有做了一些 add 工作, 这一步让我们回到 上一次的 commit</span>
$ git reset --hard HEAD    
<span class="c1"># 输出</span>
HEAD is now at 904e1ba change <span class="m">2</span>
-----------------------
<span class="c1"># 看看所有的log</span>
$ git log --oneline
<span class="c1"># 输出</span>
904e1ba change <span class="m">2</span>
c6762a1 change <span class="m">1</span>
13be9a7 create 1.py
-----------------------
<span class="c1"># 回到 c6762a1 change 1</span>
<span class="c1"># 方式1: &#34;HEAD^&#34;</span>
$ git reset --hard HEAD^  

<span class="c1"># 方式2: &#34;commit id&#34;</span>
$ git reset --hard c6762a1
-----------------------
<span class="c1"># 看看现在的 log</span>
$ git log --oneline
<span class="c1"># 输出</span>
c6762a1 change <span class="m">1</span>
13be9a7 create 1.py
</code></pre></td></tr></table>
</div>
</div><p>此时回到了<code>change 1</code>, 在此之后的修改都消失了，我们可以查看 <code>$ git reflog</code> 里面最近做的所有 <code>HEAD</code> 的改动, 并选择想要回到的 <code>commit id</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ git reflog
<span class="c1"># 输出</span>
c6762a1 HEAD@<span class="o">{</span>0<span class="o">}</span>: reset: moving to c6762a1
904e1ba HEAD@<span class="o">{</span>1<span class="o">}</span>: commit <span class="o">(</span>amend<span class="o">)</span>: change <span class="m">2</span>
<span class="m">0107760</span> HEAD@<span class="o">{</span>2<span class="o">}</span>: commit: change <span class="m">2</span>
c6762a1 HEAD@<span class="o">{</span>3<span class="o">}</span>: commit: change <span class="m">1</span>
13be9a7 HEAD@<span class="o">{</span>4<span class="o">}</span>: commit <span class="o">(</span>initial<span class="o">)</span>: create 1.py
</code></pre></td></tr></table>
</div>
</div><p>重复 <code>reset</code> 步骤就能回到 <code>commit (amend): change 2</code> (id=904e1ba)这一步了:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ git reset --hard 904e1ba
$ git log --oneline
<span class="c1"># 输出</span>
904e1ba change <span class="m">2</span>
c6762a1 change <span class="m">1</span>
13be9a7 create 1.py
</code></pre></td></tr></table>
</div>
</div><p>我们又再次回到了 <code>change 2</code>.</p>
<h3 id="checkout改写文件">(checkout）改写文件</h3>
<p>其实 <code>checkout</code> 最主要的用途并不是让单个文件回到过去, 我们之后会继续讲 <code>checkout</code> 在分支 <code>branch</code> 中的应用, 这一节主要讲 <code>checkout</code> 让文件回到过去.</p>
<p>我们现在的版本库中有两个文件:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">- gitTUT
    - 1.py
    - 2.py
</code></pre></td></tr></table>
</div>
</div><p>我们仅仅要对 <code>1.py</code> 进行回到过去操作, 回到 <code>c6762a1 change 1</code> 这一个 <code>commit</code>. 使用 <code>checkout</code> + id <code>c6762a1</code> + <code>--</code> + 文件目录 <code>1.py</code>, 我们就能将 <code>1.py</code> 的指针 <code>HEAD</code> 放在这个时刻 <code>c6762a1</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ git log --oneline
<span class="c1"># 输出</span>
904e1ba change <span class="m">2</span>
c6762a1 change <span class="m">1</span>
13be9a7 create 1.py
---------------------
$ git checkout c6762a1 -- 1.py
</code></pre></td></tr></table>
</div>
</div><p>这时 <code>1.py</code> 文件的内容就变成了:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">a = 1
</code></pre></td></tr></table>
</div>
</div><p>我们在 <code>1.py</code> 加上一行内容 <code># I went back to change 1</code> 然后 <code>add</code> 并 <code>commit</code> <code>1.py</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ git add 1.py
$ git commit -m <span class="s2">&#34;back to change 1 and add comment for 1.py&#34;</span>
$ git log --oneline

<span class="c1"># 输出</span>
47f167e back to change <span class="m">1</span> and add comment <span class="k">for</span> 1.py
904e1ba change <span class="m">2</span>
c6762a1 change <span class="m">1</span>
13be9a7 create 1.py
</code></pre></td></tr></table>
</div>
</div><p>可以看出, 不像 <code>reset</code> 时那样, 我们的 <code>change 2</code> 并没有消失, 但是 <code>1.py</code> 却已经回去了过去, 并改写了未来.</p>
<h2 id="分支管理">分支管理</h2>
<h3 id="branch-dev使用branch创建分支">(branch dev）使用branch创建分支</h3>
<p>我们建立另一个分支 <code>dev</code>, 并查看所有分支:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ git branch dev    <span class="c1"># 建立 dev 分支</span>
$ git branch        <span class="c1"># 查看当前分支</span>

<span class="c1"># 输出</span>
  dev       
* master    <span class="c1"># * 代表了当前的 HEAD 所在的分支</span>
</code></pre></td></tr></table>
</div>
</div><p>当我们想把 <code>HEAD</code> 切换去 <code>dev</code> 分支的时候, 我们可以用到上次说的 <code>checkout</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ git checkout dev

<span class="c1"># 输出</span>
Switched to branch <span class="s1">&#39;dev&#39;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="log---oneline---graph使用graph观看分支">(log &ndash;oneline &ndash;graph）使用graph观看分支</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ git branch

<span class="c1"># 输出</span>
* dev       <span class="c1"># 这时 HEAD 已经被切换至 dev 分支</span>
  master
  
$ git log --oneline --graph

<span class="c1"># 输出</span>
* 9f3367b <span class="o">(</span>HEAD -&gt; dev<span class="o">)</span> create dev branch
* 9aeb5f1 <span class="o">(</span>master<span class="o">)</span> create second.py
* d722a66 create first.py
</code></pre></td></tr></table>
</div>
</div><h3 id="checkout--b直接创建并切换到新建的分支">(checkout -b）直接创建并切换到新建的分支</h3>
<p>使用 <code>checkout -b</code> + 分支名, 就能直接创建和切换到新建的分支:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ git checkout -b  dev

<span class="c1"># 输出</span>
Switched to a new branch <span class="s1">&#39;dev&#39;</span>
--------------------------
$ git branch

<span class="c1"># 输出</span>
* dev       <span class="c1"># 这时 HEAD 已经被切换至 dev 分支</span>
  master
</code></pre></td></tr></table>
</div>
</div><h3 id="merge将-dev-的修改推送到-master">(merge）将 dev 的修改推送到 master</h3>
<p>们 <code>dev</code> 中的修改推送到 <code>master</code> 中，首先要切换到 <code>master</code>, 再将 <code>dev</code> 推送过来.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ git checkout master   <span class="c1"># 切换至 master 才能把其他分支合并过来</span>

$ git merge dev         <span class="c1"># 将 dev merge 到 master 中</span>
$ git log --oneline --graph

<span class="c1"># 输出</span>
* f9584f8 change <span class="m">3</span> in dev
* 47f167e back to change <span class="m">1</span> and add comment <span class="k">for</span> 1.py
* 904e1ba change <span class="m">2</span>
* c6762a1 change <span class="m">1</span>
* 13be9a7 create 1.py
</code></pre></td></tr></table>
</div>
</div><p>要注意的是, 如果直接 <code>git merge dev</code>, git 会采用默认的 <code>Fast forward</code> 格式进行 <code>merge</code>, 这样 <code>merge</code> 的这次操作不会有 <code>commit</code> 信息. <code>log</code> 中也不会有分支的图案. 我们可以采取 <code>--no-ff</code> 这种方式保留 <code>merge</code> 的 <code>commit</code> 信息.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ git merge --no-ff -m <span class="s2">&#34;keep merge info&#34;</span> dev         <span class="c1"># 保留 merge 信息</span>
$ git log --oneline --graph

<span class="c1"># 输出</span>
*   c60668f keep merge info
<span class="p">|</span><span class="se">\ </span> 
<span class="p">|</span> * f9584f8 change <span class="m">3</span> in dev         <span class="c1"># 这里就能看出, 我们建立过一个分支</span>
<span class="p">|</span>/  
* 47f167e back to change <span class="m">1</span> and add comment <span class="k">for</span> 1.py
* 904e1ba change <span class="m">2</span>
* c6762a1 change <span class="m">1</span>
* 13be9a7 create 1.py
</code></pre></td></tr></table>
</div>
</div><h3 id="commit解决冲突">(commit）解决冲突</h3>
<p>如果对于同一个文件，master和dev进行了不同的修改，也就是说在 <code>master</code> 和 <code>dev</code> 上的版本是不同的，此时<code>merge</code> 就会有冲突，提示为</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">Auto-merging 1.py CONFLICT <span class="o">(</span>content<span class="o">)</span>: Merge conflict in 1.py Automatic merge failed<span class="p">;</span> fix conflicts and <span class="k">then</span> commit the result.
</code></pre></td></tr></table>
</div>
</div><p>此时分支其实已经合并了，但是存在冲突的文件会被git自动进行标注，以方便我们解决冲突，打开1.py可以看到</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="nv">a</span> <span class="o">=</span> <span class="m">1</span>
<span class="c1"># I went back to change 1</span>
<span class="o">&lt;&lt;&lt;&lt;&lt;&lt;</span>&lt; HEAD
<span class="c1"># edited in master</span>
<span class="o">=======</span>
<span class="c1"># edited in dev</span>
&gt;&gt;&gt;&gt;&gt;&gt;&gt; dev
</code></pre></td></tr></table>
</div>
</div><p>我们只需要手动处理被标记出来的冲突行即可，可以这么进行理解，对于该冲突文件，git进行标记，产生了一个不同于master和dev的第三个版本的文件，此时我们需要手动将该文件编辑为合适的正确的第三版本文件，并记得解决完冲突后进行commit，将其确定为主分支的唯一版本。
然后再 <code>commit</code> 现在的文件, 冲突就解决啦.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ git commit -am <span class="s2">&#34;solve conflict&#34;</span>
</code></pre></td></tr></table>
</div>
</div><p>再来看看 <code>master</code> 的 <code>log</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ git log --oneline --graph

<span class="c1"># 输出</span>
*   <span class="m">7810065</span> solve conflict
<span class="p">|</span><span class="se">\ </span> 
<span class="p">|</span> * f7d2e3a change <span class="m">3</span> in dev
* <span class="p">|</span> 3d7796e change <span class="m">4</span> in master
<span class="p">|</span>/  
* 47f167e back to change <span class="m">1</span> and add comment <span class="k">for</span> 1.py
* 904e1ba change <span class="m">2</span>
* c6762a1 change <span class="m">1</span>
* 13be9a7 create 1.py
</code></pre></td></tr></table>
</div>
</div><p>可以看到，第一次merge时，并没有产生版本号，也就是出现冲突后产生了一个“待解决”过渡版本，随后我们解决完冲突后进行commit才可以产生正确的唯一分支。</p>
<h3 id="rebase变基">(rebase）变基</h3>
<p>同样是合并， <code>rebase</code> 的做法和 <code>merge</code> 不一样.</p>
<p>假设共享的 branch 是 <code>branch B</code>, 而我在 <code>branch A</code> 上工作, 有一天我发现<code>branch B</code>已经有一些小更新, 我也想试试我的程序和这些小更新兼不兼容, 但我并不想直接合并我的未完成版本到 <code>branch A</code>上, 这时就可以用 <code>rebase</code> 来补充我的分支<code>branch B</code>的内容. 补充完以后, 和后面那张图的 <code>merge</code> 不同, 我还是继续在 <code>C3</code> 上工作, 不过此时的 <code>C3</code> 的本质却不一样了, 因为吸收了那些小更新. 所以我们用 <code>C3'</code> 来代替.</p>
<p><figure><a class="lightgallery" href="/posts/git/Pasted%20image%2020210901175904.png" title="/posts/git/Pasted%20image%2020210901175904.png" data-thumbnail="/posts/git/Pasted%20image%2020210901175904.png" data-sub-html="<h2>原分支</h2>">
        <img
            class="lazyload"
            data-src="Pasted%20image%2020210901175904.png"
            data-srcset="/posts/git/Pasted%20image%2020210901175904.png, Pasted%20image%2020210901175904.png 1.5x, /posts/git/Pasted%20image%2020210901175904.png 2x"
            data-sizes="auto"
            alt="/posts/git/Pasted%20image%2020210901175904.png"
        />
    </a><figcaption class="image-caption">原分支</figcaption>
    </figure></p>
<p><figure><a class="lightgallery" href="/posts/git/Pasted%20image%2020210901175908.png" title="/posts/git/Pasted%20image%2020210901175908.png" data-thumbnail="/posts/git/Pasted%20image%2020210901175908.png" data-sub-html="<h2>将C3变为变基状态</h2>">
        <img
            class="lazyload"
            data-src="Pasted%20image%2020210901175908.png"
            data-srcset="/posts/git/Pasted%20image%2020210901175908.png, Pasted%20image%2020210901175908.png 1.5x, /posts/git/Pasted%20image%2020210901175908.png 2x"
            data-sizes="auto"
            alt="/posts/git/Pasted%20image%2020210901175908.png"
        />
    </a><figcaption class="image-caption">将C3变为变基状态</figcaption>
    </figure></p>
<p><figure><a class="lightgallery" href="/posts/git/Pasted%20image%2020210901175912.png" title="/posts/git/Pasted%20image%2020210901175912.png" data-thumbnail="/posts/git/Pasted%20image%2020210901175912.png" data-sub-html="<h2>将C3的基变为C4</h2>">
        <img
            class="lazyload"
            data-src="Pasted%20image%2020210901175912.png"
            data-srcset="/posts/git/Pasted%20image%2020210901175912.png, Pasted%20image%2020210901175912.png 1.5x, /posts/git/Pasted%20image%2020210901175912.png 2x"
            data-sizes="auto"
            alt="/posts/git/Pasted%20image%2020210901175912.png"
        />
    </a><figcaption class="image-caption">将C3的基变为C4</figcaption>
    </figure></p>
<p><figure><a class="lightgallery" href="/posts/git/Pasted%20image%2020210901175916.png" title="/posts/git/Pasted%20image%2020210901175916.png" data-thumbnail="/posts/git/Pasted%20image%2020210901175916.png" data-sub-html="<h2>以C4为新的基，原分支A上的修改被合并</h2>">
        <img
            class="lazyload"
            data-src="Pasted%20image%2020210901175916.png"
            data-srcset="/posts/git/Pasted%20image%2020210901175916.png, Pasted%20image%2020210901175916.png 1.5x, /posts/git/Pasted%20image%2020210901175916.png 2x"
            data-sizes="auto"
            alt="/posts/git/Pasted%20image%2020210901175916.png"
        />
    </a><figcaption class="image-caption">以C4为新的基，原分支A上的修改被合并</figcaption>
    </figure></p>
<p>可以看出 <code>rebase</code> 改变了 <code>C3</code> 的属性, <code>C3</code> 已经不是从 <code>C1</code> 衍生而来的了. 这一点和 <code>merge</code> 不一样. <code>merge</code> 在合并的时候创建了一个新的 <code>C5</code> <code>commit</code>. 这一点不同, 使得在共享分支中使用 <code>rebase</code> 变得危险. 如果是共享分支的历史被改写. 别人之前共享内容的 <code>commit</code> 就被你的 <code>rebase</code> 修改掉了.</p>
<p><figure><a class="lightgallery" href="/posts/git/Pasted%20image%2020210901175926.png" title="/posts/git/Pasted%20image%2020210901175926.png" data-thumbnail="/posts/git/Pasted%20image%2020210901175926.png" data-sub-html="<h2>改写历史</h2>">
        <img
            class="lazyload"
            data-src="Pasted%20image%2020210901175926.png"
            data-srcset="/posts/git/Pasted%20image%2020210901175926.png, Pasted%20image%2020210901175926.png 1.5x, /posts/git/Pasted%20image%2020210901175926.png 2x"
            data-sizes="auto"
            alt="/posts/git/Pasted%20image%2020210901175926.png"
        />
    </a><figcaption class="image-caption">改写历史</figcaption>
    </figure></p>
<p>此外，需要注意的是， <strong>!!! 只能在你自己的分支中使用 rebase, 和别人共享的部分是不能用的 !!!</strong></p>
<p>初始的版本库还是和上回一样, 在 <code>master</code> 和 <code>dev</code> 分支中都有自己的独立修改.</p>
<p>在 <code>master</code>创建一个文件后，产生分支，在 <code>master</code>中继续创建第二个文件，然后在dev分支中分两次在文件一中进行修改。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="c1"># 这是 master 的 log</span>
* bf75fad <span class="o">(</span>HEAD -&gt; master<span class="o">)</span> create <span class="m">2</span>  
* f1e708f create <span class="m">1</span>
-----------------------------
<span class="c1"># 这是 dev 的 log</span>
* 103ebbd <span class="o">(</span>HEAD -&gt; dev<span class="o">)</span> add <span class="m">2</span> in dev  
* 7de4a5b add <span class="m">1</span> in dev  
* f1e708f create <span class="m">1</span>
</code></pre></td></tr></table>
</div>
</div><p>当我们想要用 rebase 合并 master 到 dev的时候:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ git branch

<span class="c1"># 输出</span>
 *dev
  master
-------------------------
$ git rebase master 

<span class="c1"># 输出</span>
First, rewinding head to replay your work on top of it...
Applying: change <span class="m">3</span> in dev
Using index info to reconstruct a base tree...
M   1.py
Falling back to patching base and 3-way merge...
Auto-merging 1.py
CONFLICT <span class="o">(</span>content<span class="o">)</span>: Merge conflict in 1.py
error: Failed to merge in the changes.
Patch failed at <span class="m">0001</span> change <span class="m">3</span> in dev
The copy of the patch that failed is found in: .git/rebase-apply/patch

When you have resolved this problem, run <span class="s2">&#34;git rebase --continue&#34;</span>.
If you prefer to skip this patch, run <span class="s2">&#34;git rebase --skip&#34;</span> instead.
To check out the original branch and stop rebasing, run <span class="s2">&#34;git rebase --abort&#34;</span>.
</code></pre></td></tr></table>
</div>
</div><p>git 发现的我们的 1.py 在 master 和 dev 上的版本是不同的, 所以提示 merge 有冲突. 具体的冲突, git 已经帮我们标记出来, 我们打开 1.py 就能看到:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="nv">a</span> <span class="o">=</span> <span class="m">1</span>
<span class="c1"># I went back to change 1</span>
<span class="o">&lt;&lt;&lt;&lt;&lt;&lt;</span>&lt; f7d2e3a047be4624e83c1265a0946e2e8790f79c
<span class="c1"># edited in dev</span>
<span class="o">=======</span>
<span class="c1"># edited in master</span>
&gt;&gt;&gt;&gt;&gt;&gt;&gt; change <span class="m">4</span> in master
</code></pre></td></tr></table>
</div>
</div><p>这时 HEAD 并没有指向 master 或者 dev, 而是停在了 rebase 模式上:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ git branch
* <span class="o">(</span>no branch, rebasing master<span class="o">)</span> <span class="c1"># HEAD 在这</span>
  dev
  master
</code></pre></td></tr></table>
</div>
</div><p>所以我们打开 1.py, 手动合并一下两者的不同.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">a = 1
# I went back to change 1
​
# edited in master and dev
</code></pre></td></tr></table>
</div>
</div><p>然后执行 git add 和 git rebase &ndash;continue 就完成了 rebase 的操作了.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ git add 1.py
$ git rebase --continue
</code></pre></td></tr></table>
</div>
</div><p>此时来看看dev的log</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">* 7f28382 <span class="o">(</span>HEAD -&gt; dev<span class="o">)</span> add <span class="m">2</span> in dev  
* 7f26325 add <span class="m">1</span> in dev  <span class="c1"># 基于现在最新的bf75fad进行修改</span>
* bf75fad <span class="o">(</span>master<span class="o">)</span> create <span class="m">2</span>  
* f1e708f create <span class="m">1</span>
</code></pre></td></tr></table>
</div>
</div><p>!! 注意 !! 这个例子也说明了使用 rebase 要万分小心, 千万不要在共享的 branch 中 rebase, 不然就像上面那样, 现在 dev 的历史已经被 rebase 改变了. dev 当中别人提交的 change 就被你无情地修改掉了, 所以千万不要在共享分支中使用 rebase.但你可以选择在rebase后merge到master中</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ git checkout master
切换到分支 <span class="s1">&#39;master&#39;</span>
$ git merge dev
更新 bf75fad..7f28382  
Fast-forward  
1.py <span class="p">|</span> <span class="m">3</span> +++  
<span class="m">1</span> file changed, <span class="m">3</span> insertions<span class="o">(</span>+<span class="o">)</span>
</code></pre></td></tr></table>
</div>
</div><p>再来看看 master 的 log:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ git log --oneline --graph

<span class="c1"># 输出</span>
7f28382 <span class="o">(</span>HEAD -&gt; master, dev<span class="o">)</span> add <span class="m">2</span> in dev <span class="c1"># dev中的修改被合并到master中，且没有产生分支</span>
7f26325 add <span class="m">1</span> in dev  
bf75fad create <span class="m">2</span>  
f1e708f create <span class="m">1</span>

</code></pre></td></tr></table>
</div>
</div><h3 id="stash临时修改">(stash）临时修改</h3>
<p>假如我们正在进行任务A，但是突然有一个紧急bug修改任务B，但是我并不想把我现在的未完成任务A一起提交或者丢弃，此时我们就可以使用<code>stash</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ git status -s
<span class="c1"># 输出</span>
 M 1.py
------------------ 
$ git stash
<span class="c1"># 输出</span>
Saved working directory and index state WIP on dev: f7d2e3a change <span class="m">3</span> in dev
HEAD is now at f7d2e3a change <span class="m">3</span> in dev
-------------------
$ git status
<span class="c1"># 输出</span>
On branch dev
nothing to commit, working directory clean  <span class="c1"># 干净得很</span>
</code></pre></td></tr></table>
</div>
</div><p>随后我们完成任务B
完成了, 现在可以继续开心的在 <code>dev</code> 上刷代码了.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ git checkout dev
$ git stash list    <span class="c1"># 查看在 stash 中的缓存</span>

<span class="c1"># 输出</span>
stash@<span class="o">{</span>0<span class="o">}</span>: WIP on dev: f7d2e3a change <span class="m">3</span> in dev
</code></pre></td></tr></table>
</div>
</div><p>上面说明在 <code>dev</code> 中, 我们的确有 <code>stash</code> 的工作. 现在可以通过 <code>pop</code> 来提取这个并继续工作了.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ git stash pop

<span class="c1"># 输出</span>
On branch dev
Changes not staged <span class="k">for</span> commit:
  <span class="o">(</span>use <span class="s2">&#34;git add &lt;file&gt;...&#34;</span> to update what will be committed<span class="o">)</span>
  <span class="o">(</span>use <span class="s2">&#34;git checkout -- &lt;file&gt;...&#34;</span> to discard changes in working directory<span class="o">)</span>

    modified:   1.py

no changes added to commit <span class="o">(</span>use <span class="s2">&#34;git add&#34;</span> and/or <span class="s2">&#34;git commit -a&#34;</span><span class="o">)</span>
Dropped refs/stash@<span class="o">{</span>0<span class="o">}</span> <span class="o">(</span>23332b7edc105a579b09b127336240a45756a91c<span class="o">)</span>
----------------------
$ git status -s
<span class="c1"># 输出</span>
 M 1.py     <span class="c1"># 和最开始一样了</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="merge和rebase的区别">merge和rebase的区别</h2>
<p>参考<a href="https://www.jianshu.com/p/39c45f990c99" target="_blank" rel="noopener noreffer">git rebase的一点理解</a></p>
<h3 id="merge">merge</h3>
<p>merge是我们常用的合并分支的命令：
假如开发中：分叉到两个不同的分支，右各自有新的提交：</p>
<p><figure><a class="lightgallery" href="/posts/git/Pasted%20image%2020210901183914.png" title="image" data-thumbnail="/posts/git/Pasted%20image%2020210901183914.png" data-sub-html="<h2>原分支</h2><p>image</p>">
        <img
            class="lazyload"
            data-src="Pasted%20image%2020210901183914.png"
            data-srcset="/posts/git/Pasted%20image%2020210901183914.png, Pasted%20image%2020210901183914.png 1.5x, /posts/git/Pasted%20image%2020210901183914.png 2x"
            data-sizes="auto"
            alt="/posts/git/Pasted%20image%2020210901183914.png"
        />
    </a><figcaption class="image-caption">原分支</figcaption>
    </figure></p>
<p>当我们使用merge命令合并时，它会把两个分支的最新提交历史（<code>C3</code> 和 <code>C4</code>）和这个两个分支的最近的祖先（<code>C2</code>）进行三方合并，合并的结果就是生成一个新的提交历史。
举例子来说
假如C2共ABC三个文件
甲在master的基础上修改bug，在A中删除了代码，在C中修改了代码
乙创建新分支来增加功能，在B中新增了代码，在C中修改了代码
而后进行merge，基于C2来进行三方合并，于是在A中删除部分代码，在B中新增代码，然后讨论解决一下C中的冲突，创建了C5版本，完成合并</p>
<p><figure><a class="lightgallery" href="/posts/git/Pasted%20image%2020210901183921.png" title="image" data-thumbnail="/posts/git/Pasted%20image%2020210901183921.png" data-sub-html="<h2>基于共同历史C2，进行三方合并</h2><p>image</p>">
        <img
            class="lazyload"
            data-src="Pasted%20image%2020210901183921.png"
            data-srcset="/posts/git/Pasted%20image%2020210901183921.png, Pasted%20image%2020210901183921.png 1.5x, /posts/git/Pasted%20image%2020210901183921.png 2x"
            data-sizes="auto"
            alt="/posts/git/Pasted%20image%2020210901183921.png"
        />
    </a><figcaption class="image-caption">基于共同历史C2，进行三方合并</figcaption>
    </figure></p>
<p>通过合并操作来整合分叉了的历史。</p>
<p>在将三方合并的时候，总是需要以一个提交历史作为依据的，在这个提交历史的基础上增加其他两个的修改，merge上使用的就是这个两个分支的最近的祖先（<code>C2</code>）作为依据。</p>
<h3 id="rebase">rebase</h3>
<p>首先我们要理解git的版本管理方式，基于上一个历史版本，存储现在的更改，而后现在的版本又作为下一个版本的历史版本。所以，回溯版本相当于把每一个历史版本的更改依次进行还原，跳转之后的版本相当于把每一次更改再重新做一遍。</p>
<p>rebase这个命令在官方的翻译中意思是：变基。</p>
<p>额，怎么说都有点怪是不是，最后查了几个词典，我觉得把rebase翻译为：重定基底</p>
<p>重定基底有两词语组成：</p>
<ul>
<li>重定：动词，重新确定的意思</li>
<li>基底：名词，就是依据，把某种事物作为依托或根据，在git中，这个依据的事物就是<strong>提交历史</strong></li>
</ul>
<p>合起来就是：重新确定所依据的提交历史。</p>
<p>rebase同样是通过合并来整合分叉的历史，唯一的不同就是，<strong>合并时所依据的提交历史不同</strong>（基），它是直接拿两个分支的最新提交历史（<code>C3</code> 和 <code>C4</code>）中的一个作为依据（即基），比如以<code>C3</code>为基础，提取在 <code>C4</code> 中引入的补丁和修改，然后在 <code>C3</code> 的基础上应用一次。</p>
<p>这个过程就相当于改变<code>C4</code>的基底为<code>C3</code>，并将<code>C4</code>上的修改依序应用于<code>C3</code> 上，生成新的<code>C4'</code>, 这个过程就改变了<code>C4</code>的基底，也就是所谓的<strong>变基</strong>。</p>
<p><figure><a class="lightgallery" href="/posts/git/Pasted%20image%2020210901184802.png" title="image" data-thumbnail="/posts/git/Pasted%20image%2020210901184802.png" data-sub-html="<h2>改变C4的基底为C3，并将C4上的修改依序应用于C3 上，生成新的C4&#39;</h2><p>image</p>">
        <img
            class="lazyload"
            data-src="Pasted%20image%2020210901184802.png"
            data-srcset="/posts/git/Pasted%20image%2020210901184802.png, Pasted%20image%2020210901184802.png 1.5x, /posts/git/Pasted%20image%2020210901184802.png 2x"
            data-sizes="auto"
            alt="/posts/git/Pasted%20image%2020210901184802.png"
        />
    </a><figcaption class="image-caption">改变C4的基底为C3，并将C4上的修改依序应用于C3 上，生成新的C4'</figcaption>
    </figure></p>
<p>将 <code>C4</code> 中的修改变基到 <code>C3</code> 上。</p>
<p><code>git rebase [basebranch][topicbranch]</code> ， 以basebranch为基，将topicbranch的修改应用于basebranch上。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ git checkout experiment
$ git rebase master
First, rewinding head to replay your work on top of it...
Applying: added staged <span class="nb">command</span>
</code></pre></td></tr></table>
</div>
</div><p>这时experiment分支的提交历史就已经改变了，master分支在experiment分支之后。</p>
<p>现在回到 <code>master</code> 分支，进行一次快进合并。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ git checkout master
$ git merge experiment
</code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="/posts/git/Pasted%20image%2020210901184906.png" title="image" data-thumbnail="/posts/git/Pasted%20image%2020210901184906.png" data-sub-html="<h2>变基合并可以让最后只剩下一条主线分支</h2><p>image</p>">
        <img
            class="lazyload"
            data-src="Pasted%20image%2020210901184906.png"
            data-srcset="/posts/git/Pasted%20image%2020210901184906.png, Pasted%20image%2020210901184906.png 1.5x, /posts/git/Pasted%20image%2020210901184906.png 2x"
            data-sizes="auto"
            alt="/posts/git/Pasted%20image%2020210901184906.png"
        />
    </a><figcaption class="image-caption">变基合并可以让最后只剩下一条主线分支</figcaption>
    </figure></p>
<p>此时，C4' 指向的快照就和上面使用 merge 命令的例子中 C5 指向的快照一模一样了。</p>
<p>这两种整合方法的最终结果没有任何区别，但是变基使得提交历史更加整洁。如果开发中使用rebase，可以使得最终的开发版本历史只有一条清晰的主分支，在分支上进行的修改也呈现线性记录。</p>
<h3 id="区别">区别</h3>
<p>无论是通过变基，还是通过三方合并，最后所生成的结果是一样的，只是他们所生成体提交历史不同。</p>
<p>变基：将一个分支的一系列的提交按顺序应用到另一分支上，前者的所有历史更改被合并为一个大的历史更改保存在历史中。</p>
<p>三方合并：把两方的最后提交合并在一起，因为他们分别的最后提交的版本是基于他们的共同祖先依次迭代更改生成的，所以合并后，每一个分支的所有历史都会被保留。</p>
<p>变基操作的实际是：丢弃一个分支上现有的提交，在另一个分支上新建这些内容但实际上不同的提交。</p>
<h2 id="补充">补充</h2>
<p>当你进行了修改，但是没有add和commit时，此时切换到其他分支，如果当前的修改会被覆盖，git会进行警告。</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>更新于 2021-09-01</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/posts/git/index.md" target="_blank" rel="noopener noreferrer">阅读原始文档</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="#" onclick="return false;" title="分享到 Twitter" data-sharer="twitter" data-url="http://imzifeng.cn/posts/git/" data-title="Git"><i class="fab fa-twitter fa-fw"></i></a><a href="#" onclick="return false;" title="分享到 Facebook" data-sharer="facebook" data-url="http://imzifeng.cn/posts/git/"><i class="fab fa-facebook-square fa-fw"></i></a><a href="#" onclick="return false;" title="分享到 WhatsApp" data-sharer="whatsapp" data-url="http://imzifeng.cn/posts/git/" data-title="Git" data-web><i class="fab fa-whatsapp fa-fw"></i></a><a href="#" onclick="return false;" title="分享到 微博" data-sharer="weibo" data-url="http://imzifeng.cn/posts/git/" data-title="Git"><i class="fab fa-weibo fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"></section>
        <section>
            <span><a href="#" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/rnaseq-1/" class="prev" rel="prev" title="RNA-seq基础-1-环境配置"><i class="fas fa-angle-left fa-fw"></i>RNA-seq基础-1-环境配置</a>
            <a href="/posts/usbflashdiskantivirus/" class="next" rel="next" title="U盘不完全防毒">U盘不完全防毒<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
<div id="comments"><div id="twikoo"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://twikoo.js.org/">Twikoo</a>.
            </noscript></div></article></div>
        </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">由 <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.85.0">Hugo</a> 强力驱动 | 主题 - <a href="https://github.com/HEIGE-PCloud/DoIt" target="_blank" rel="noopener noreffer" title="DoIt 0.2.10"><i class="far fa-edit fa-fw"></i> DoIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2017 - 2021</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank" rel="noopener noreferrer">zifeng</a></span></div>
        </div></footer></div>

    <div id="fixed-buttons"><a href="#back-to-top" id="back-to-top-button" class="fixed-button" title="回到顶部">
            <i class="fas fa-arrow-up fa-fw"></i>
        </a><a href="#" id="view-comments" class="fixed-button" title="查看评论">
            <i class="fas fa-comment fa-fw"></i>
        </a>
    </div><div class="assets"><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/fuse/fuse.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/topbar/topbar.min.js"></script><script type="text/javascript" src="/lib/pjax/pjax.min.js"></script><script type="text/javascript" src="/js/theme.min.js"></script></div>

<div class="pjax-assets"><script type="text/javascript" src="/lib/twikoo/twikoo.all.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lightgallery.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lg-thumbnail.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lg-zoom.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":20},"comment":{"twikoo":{"el":"#twikoo","envId":"https://twikoo-comment-for-blog-4nu21org3-hermitalap.vercel.app/","lang":"zh-cn","region":"ap-shanghai"}},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true},"search":{"distance":100,"findAllMatches":false,"fuseIndexURL":"/index.json","highlightTag":"em","ignoreFieldNorm":false,"ignoreLocation":false,"isCaseSensitive":false,"location":0,"maxResultLength":10,"minMatchCharLength":2,"noResultsFound":"没有找到结果","snippetLength":50,"threshold":0.3,"type":"fuse","useExtendedSearch":false},"sharerjs":true};</script><link rel="stylesheet" href="/lib/lightgallery/lightgallery.min.css"></div>
</body>

</html>